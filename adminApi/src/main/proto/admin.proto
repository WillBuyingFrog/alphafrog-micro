syntax = "proto3";

package world.willfrog.alphafrogmicro.admin.idl;

option java_multiple_files = true;
option java_package = "world.willfrog.alphafrogmicro.admin.idl";
option java_outer_classname = "AdminServiceProto";

message AdminProfile {
  int64 user_id = 1;
  string username = 2;
  string email = 3;
  int32 user_type = 4;
  int32 user_level = 5;
  int32 credit = 6;
  int64 register_time = 7;
}

message AdminLoginRequest {
  string username = 1;
  string password = 2;
}

message AdminLoginResponse {
  bool valid = 1;
  string message = 2;
  AdminProfile profile = 3;
}

message AdminCreateRequest {
  string username = 1;
  string password = 2;
  string email = 3;
  string magic_password = 4;
}

message AdminDeleteRequest {
  string username = 1;
  string magic_password = 2;
}

message AdminActionResponse {
  bool success = 1;
  string message = 2;
}

message AdminOverallRequest {}

message AdminOverallResponse {
  int64 fund_count = 1;
  int64 index_count = 2;
  int64 stock_count = 3;
  int64 fund_nav_count = 4;
  int64 index_daily_count = 5;
  int64 stock_daily_count = 6;
}

// 额度申请相关消息
message CreditApplication {
  string application_id = 1;
  string user_id = 2;
  int32 amount = 3;
  string reason = 4;
  string contact = 5;
  string status = 6;
  string created_at = 7;
  string processed_at = 8;
}

message ListCreditApplicationsRequest {
  string status = 1;  // PENDING, APPROVED, REJECTED, 空表示全部
  int32 page = 2;
  int32 page_size = 3;
}

message ListCreditApplicationsResponse {
  bool success = 1;
  string message = 2;
  repeated CreditApplication applications = 3;
  int32 total = 4;
  int32 page = 5;
  int32 page_size = 6;
}

message ProcessCreditApplicationRequest {
  string application_id = 1;
  string admin_id = 2;
}

message ProcessCreditApplicationResponse {
  bool success = 1;
  string message = 2;
  CreditApplication application = 3;
}

service AdminService {
  rpc validateAdminLogin(AdminLoginRequest) returns (AdminLoginResponse);
  rpc createAdmin(AdminCreateRequest) returns (AdminActionResponse);
  rpc deleteAdmin(AdminDeleteRequest) returns (AdminActionResponse);
  rpc getAdminOverall(AdminOverallRequest) returns (AdminOverallResponse);
  
  // 额度申请管理
  rpc listCreditApplications(ListCreditApplicationsRequest) returns (ListCreditApplicationsResponse);
  rpc approveCreditApplication(ProcessCreditApplicationRequest) returns (ProcessCreditApplicationResponse);
  rpc rejectCreditApplication(ProcessCreditApplicationRequest) returns (ProcessCreditApplicationResponse);
}
