spring:
  config:
    import: "optional:file:test-secrets.yml" # Imports secrets from a YAML file at the module root

  datasource:
    url: jdbc:postgresql://${TEST_DB_HOST:localhost}:${TEST_DB_PORT:5432}/${TEST_DB_NAME:portfolio_test_db}
    username: ${TEST_DB_USER:sa}
    password: ${TEST_DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate # Changed from create-drop to prevent data loss
    show-sql: true # Useful for debugging tests

  data:
    redis:
      host: ${TEST_REDIS_HOST:localhost}
      port: ${TEST_REDIS_PORT:6379}
      # password: ${TEST_REDIS_PASSWORD:} # Uncomment if Redis password is used and set in test-secrets.yml

dubbo:
  registry:
    address: nacos://${NACOS_ADDRESS_TEST:127.0.0.1:8848}
  # It might be useful to disable consumer checks for tests if services are not always up
  # consumer:
  #   check: false
  protocol:
    name: tri # Or your desired protocol
    port: -1 # Use a random port for testing to avoid conflicts

# Activate "it" profile for these configurations automatically via spring.profiles.active in test classes or maven
# For example, by using @ActiveProfiles("it") on your test class.
# Or ensure the surefire plugin activates it. 